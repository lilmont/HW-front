<h1 class="text-xl lg:text-2xl font-bold mb-6">{{isAddMode ? Messages.Headers.addCourse :Messages.Headers.editCourse}}
</h1>


<form (ngSubmit)="AddOrEditCourse()" class="mx-auto p-6 bg-white rounded shadow space-y-6">

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <!-- ID (readonly) -->
        <div>
            <label class="block mb-1 font-semibold text-gray-700">{{Messages.TableHeaders.id}}</label>
            <input type="number" [value]="courseDetail.id" readonly
                class="border rounded px-3 py-2 w-full bg-gray-100 cursor-not-allowed" />
        </div>

        <!-- Date Created (readonly) -->
        <div>
            <label class="block mb-1 font-semibold text-gray-700">{{Messages.Labels.dateCreated}}</label>
            <input type="text" [value]="courseDetail.dateCreated | jalaliDate" readonly
                class="border rounded px-3 py-2 w-full bg-gray-100 cursor-not-allowed" />
        </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <!-- Title -->
        <div>
            <label class="block mb-1 font-semibold text-gray-700">{{Messages.TableHeaders.title}}</label>
            <input type="text" [(ngModel)]="courseDetail.title" name="title" class="border rounded px-3 py-2 w-full" />
        </div>
        <!-- Description -->
        <div>
            <label class="block mb-1 font-semibold text-gray-700">{{Messages.Headers.courseDescription}}</label>
            <textarea [(ngModel)]="courseDetail.description" name="description" rows="4"
                class="border rounded px-3 py-2 w-full"></textarea>
        </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <!-- Full Description -->
        <div>
            <label class="block mb-1 font-semibold text-gray-700">{{Messages.Headers.courseFullDescription}}</label>
            <textarea [(ngModel)]="courseDetail.fullDescription" name="fullDescription" rows="4"
                class="border rounded px-3 py-2 w-full"></textarea>
        </div>
        <!-- Syllabus -->
        <div>
            <label class="block mb-1 font-semibold text-gray-700">{{Messages.Headers.syllabus}}</label>
            <quill-editor [(ngModel)]="courseDetail.syllabus" name="syllabus" [style]="{height: '200px'}"
                dir="ltr"></quill-editor>

        </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <!-- Course Session Number -->
        <div>
            <label for="price" class="block mb-1 font-semibold text-gray-700">
                {{Messages.Labels.courseSessionNumber}}
            </label>
            <input type="number" [(ngModel)]="courseDetail.courseSessionNumber" name="courseSessionNumber"
                class="border rounded px-3 py-2 w-full" dir="ltr" />
        </div>
        <!-- Course Duration -->
        <div>
            <label class="block mb-1 font-semibold text-gray-700">{{Messages.Labels.courseDurationInHours}}</label>
            <input type="number" [(ngModel)]="courseDetail.courseDurationInHours" name="courseDurationInHours"
                class="border rounded px-3 py-2 w-full" dir="ltr" />
        </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <!-- Price -->
        <div>
            <label for="price" class="block mb-1 font-semibold text-gray-700">
                {{Messages.TableHeaders.price}}
            </label>
            <input type="text" hwAmount id="price" [(ngModel)]="courseDetail.price" name="price" dir="ltr"
                class="border rounded px-3 py-2 w-full" [placeholder]="Messages.TableHeaders.price" />
        </div>
        <!-- SpotPlayer Id -->
        <div>
            <label class="block mb-1 font-semibold text-gray-700">{{Messages.Headers.spotPlayerProductId}}</label>
            <input type="text" [(ngModel)]="courseDetail.spotPlayerProductId" name="spotPlayerProductId"
                class="border rounded px-3 py-2 w-full" dir="ltr" />
        </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <!-- Status -->
        <div>
            <label for="courseStatus" class="text-sm block mb-1">{{Messages.TableHeaders.status}}</label>
            <select id="courseStatus" [(ngModel)]="courseDetail.courseStatus" name="courseStatus"
                class="border rounded p-2 w-full">
                <option [ngValue]="0">{{Messages.Headers.comingSoon}}</option>
                <option [ngValue]="1">{{Messages.Headers.InProgress}}</option>
                <option [ngValue]="2">{{Messages.Headers.completed}}</option>
            </select>
        </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="flex flex-col items-center mb-10">
            <div class="relative border border-gray-300 rounded overflow-hidden">
                <label class="block mb-1 font-semibold text-gray-700">{{Messages.Headers.courseImage}}</label>

                <!-- Image preview -->
                <img *ngIf="imagePreviewUrl || (courseDetail.courseImage && courseDetail.courseImage.trim() !== '')"
                    [src]="imagePreviewUrl ? imagePreviewUrl : baseUrl + '/uploads/courses/images/' + courseDetail.courseImage"
                    class="w-full h-full object-cover bg-gray-100" alt="Course Image" />

                <!-- Placeholder if no image -->
                <div *ngIf="!imagePreviewUrl && (!courseDetail.courseImage || courseDetail.courseImage.trim() === '')"
                    class="flex items-center justify-center bg-gray-100 text-gray-500 w-64 h-64">
                    No image uploaded
                </div>

                <!-- Upload button -->
                <label for="imageUpload"
                    class="absolute bottom-0 right-0 bg-custom-600 hover:bg-custom-700 text-white p-2 rounded-full cursor-pointer"
                    title="Upload Image">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L7 21H3v-4L16.732 3.732z">
                        </path>
                    </svg>
                </label>
                <input id="imageUpload" type="file" accept="image/*" (change)="onCourseImageSelect($event)"
                    class="hidden" />
            </div>
        </div>

        <div class="flex flex-col items-center mb-10">
            <div class="relative border border-gray-300 rounded overflow-hidden">
                <label class="block mb-1 font-semibold text-gray-700">{{Messages.Headers.courseCoverImage}}</label>

                <!-- Image preview -->
                <img *ngIf="imageCoverPreviewUrl || (courseDetail.courseCoverImage && courseDetail.courseCoverImage.trim() !== '')"
                    [src]="imageCoverPreviewUrl ? imageCoverPreviewUrl : baseUrl + '/uploads/courses/images/' + courseDetail.courseCoverImage"
                    class="w-full h-full object-cover bg-gray-100" alt="Course Cover Image" />

                <!-- Placeholder if no image -->
                <div *ngIf="!imageCoverPreviewUrl && (!courseDetail.courseCoverImage || courseDetail.courseCoverImage.trim() === '')"
                    class="flex items-center justify-center bg-gray-100 text-gray-500 w-64 h-64">
                    No image uploaded
                </div>

                <!-- Upload button -->
                <label for="imageCoverUpload"
                    class="absolute bottom-0 right-0 bg-custom-600 hover:bg-custom-700 text-white p-2 rounded-full cursor-pointer"
                    title="Upload Image">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L7 21H3v-4L16.732 3.732z">
                        </path>
                    </svg>
                </label>
                <input id="imageCoverUpload" type="file" accept="image/*" (change)="onCourseCoverImageSelect($event)"
                    class="hidden" />
            </div>
        </div>

    </div>

    <div class="flex flex-col items-center mb-10">
        <div class="relative w-full h-64 border border-gray-300 rounded overflow-hidden">
            <label class="block mb-1 font-semibold text-gray-700">{{Messages.Headers.courseVideo}}</label>

            <!-- Video preview: show selected video preview if any, else existing video -->
            <video *ngIf="videoPreviewUrl || (courseDetail.courseVideo && courseDetail.courseVideo.trim() !== '')"
                [src]="videoPreviewUrl ? videoPreviewUrl : baseUrl + '/uploads/courses/videos/' + courseDetail.courseVideo"
                controls class="w-full h-full object-contain bg-black"></video>

            <!-- Placeholder if no video to show -->
            <div *ngIf="!videoPreviewUrl && (!courseDetail.courseVideo || courseDetail.courseVideo.trim() === '')"
                class="flex items-center justify-center w-full h-full bg-gray-100 text-gray-500">
                No video uploaded
            </div>

            <!-- Upload button -->
            <label for="videoUpload"
                class="absolute bottom-0 right-0 bg-custom-600 hover:bg-custom-700 text-white p-2 rounded-full cursor-pointer"
                title="Upload Video">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
                    xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L7 21H3v-4L16.732 3.732z">
                    </path>
                </svg>
            </label>
            <input id="videoUpload" type="file" accept="video/*" (change)="onVideoSelect($event)" class="hidden" />
        </div>
    </div>

    <!-- Sessions -->
    <div>
        <h2 class="text-lg font-semibold mb-2">{{Messages.Headers.sessions}}</h2>

        <div class="mb-2">
            <button type="button" (click)="addSession()"
                class="bg-green-600 text-white px-4 py-1 rounded hover:bg-green-700">
                + {{Messages.Buttons.addSession}}
            </button>
        </div>

        <table class="min-w-full table-auto border border-gray-300">
            <thead>
                <tr class="bg-gray-100">
                    <th class="border px-4 py-2 w-16">{{Messages.TableHeaders.id}}</th>
                    <th class="border px-4 py-2 w-16">{{Messages.TableHeaders.sessionNumber}}</th>
                    <th class="border px-4 py-2">{{Messages.TableHeaders.title}}</th>
                    <th class="border px-4 py-2">{{Messages.TableHeaders.description}}</th>
                    <th class="border px-4 py-2">{{Messages.TableHeaders.downloadLink}}</th>
                    <th class="border px-4 py-2">{{Messages.Buttons.delete}}</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let session of courseDetail.sessions; let i = index">
                    <td class="border px-2 py-1 w-16">
                        <input type="number" [(ngModel)]="session.id" name="sessionId{{i}}"
                            class="border rounded px-2 py-1 w-full text-center cursor-not-allowed" readonly />
                    </td>
                    <td class="border px-2 py-1 w-16">
                        <input type="number" [(ngModel)]="session.number" name="sessionNumber{{i}}"
                            class="border rounded px-2 py-1 w-full text-center" />
                    </td>
                    <td class="border px-2 py-1">
                        <input type="text" [(ngModel)]="session.title" name="sessionTitle{{i}}"
                            class="border rounded px-2 py-1 w-full" />
                    </td>
                    <td class="border px-2 py-1">
                        <input type="text" [(ngModel)]="session.description" name="sessionDesc{{i}}"
                            class="border rounded px-2 py-1 w-full" />
                    </td>
                    <td class="border px-2 py-1" dir="ltr">
                        <input type="text" [(ngModel)]="session.downloadLink" name="sessionDownload{{i}}"
                            class="border rounded px-2 py-1 w-full" />
                    </td>
                    <td class="border px-2 py-1 text-center">
                        <button type="button" (click)="deleteSession(i)"
                            class="cursor-pointer text-red-600 hover:text-red-800">
                            {{Messages.Buttons.delete}}
                        </button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="pt-4">
        <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700">
            {{Messages.Buttons.save}}
        </button>
    </div>
</form>